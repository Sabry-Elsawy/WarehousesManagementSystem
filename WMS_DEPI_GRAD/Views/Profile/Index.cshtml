@model WMS.DAL.Entities._Identity.ApplicationUser
@{
    ViewData["Title"] = "Profile";

    var firstNameEmpty = string.IsNullOrWhiteSpace(Model?.FirstName);
    var lastNameEmpty = string.IsNullOrWhiteSpace(Model?.LastName);
    var displayName = (firstNameEmpty && lastNameEmpty)
        ? "No Name"
        : $"{Model?.FirstName} {Model?.LastName}".Trim();
}

<div class="container py-5">
    @try
    {
        if (Model != null)
        {
            <!-- Profile Header -->
            <div class="card shadow-lg mb-4 border-0 overflow-hidden">
                <div class="card-body p-0 position-relative rounded-top"
                     style="background: linear-gradient(135deg, #4e73df 0%, #224abe 100%);">

                    <!-- Decorative overlay for depth -->
                    <div class="position-absolute w-100 h-100 top-0 start-0"
                         style="background: rgba(0,0,0,0.15);"></div>

                    <!-- Optional subtle geometric shapes -->
                    <div class="position-absolute top-0 start-0 w-100 h-100">
                        <svg width="100%" height="100%">
                            <circle cx="80" cy="50" r="60" fill="rgba(255,255,255,0.05)" />
                            <circle cx="200" cy="120" r="100" fill="rgba(255,255,255,0.07)" />
                        </svg>
                    </div>

                    <div class="d-flex align-items-center flex-wrap p-4 position-relative text-white">
                        <!-- Avatar -->
                        <div class="rounded-circle bg-white text-primary d-flex justify-content-center align-items-center me-4 shadow-lg"
                             style="width:100px; height:100px; font-size:2.2rem; font-weight:700; border: 4px solid rgba(255,255,255,0.7); box-shadow: 0 0 15px rgba(0,0,0,0.3);">
                            @( (Model.FirstName?.FirstOrDefault() ?? 'U') )@( (Model.LastName?.FirstOrDefault() ?? 'N') )
                        </div>

                        <!-- User Info -->
                        <div class="flex-grow-1">
                            <h2 class="mb-1 fw-bold text-shadow"
                                style="text-shadow: 1px 1px 3px rgba(0,0,0,0.4);">
                                @displayName
                            </h2>
                            <span class="badge bg-light text-primary fs-6 fw-semibold shadow-sm">
                                @Model.Role.ToString()
                            </span>
                            <p class="mt-2 text-white-50">
                                Welcome back!
                            </p>
                        </div>
                    </div>
                </div>
            </div>


            <div class="row g-4">
                <!-- Contact Info -->
                <div class="col-md-6">
                    <div class="card shadow-sm border-0 h-100">
                        <div class="card-header bg-white border-bottom">
                            <h5 class="mb-0 fw-semibold">
                                <i class="bi bi-person-circle me-2"></i>Contact Information
                            </h5>
                        </div>
                        <div class="card-body">
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item"><strong>Username:</strong> @Model.UserName</li>
                                <li class="list-group-item"><strong>Email:</strong> @Model.Email</li>
                                <li class="list-group-item"><strong>Phone:</strong> @Model.PhoneNumber </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Address Info -->
                <div class="col-md-6">
                    <div class="card shadow-sm border-0 h-100">
                        <div class="card-header bg-white border-bottom">
                            <h5 class="mb-0 fw-semibold">
                                <i class="bi bi-geo-alt me-2"></i>Address
                            </h5>
                        </div>
                        <div class="card-body">
                            @if (Model.Address != null)
                            {
                                <ul class="list-group list-group-flush">
                                    @if (!string.IsNullOrWhiteSpace(Model.Address.Street))
                                    {
                                        <li class="list-group-item"><strong>Street:</strong> @Model.Address.Street</li>
                                    }
                                    @if (!string.IsNullOrWhiteSpace(Model.Address.City))
                                    {
                                        <li class="list-group-item"><strong>City:</strong> @Model.Address.City</li>
                                    }
                                    @if (!string.IsNullOrWhiteSpace(Model.Address.State))
                                    {
                                        <li class="list-group-item"><strong>State:</strong> @Model.Address.State</li>
                                    }
                                    @if (!string.IsNullOrWhiteSpace(Model.Address.PostalCode))
                                    {
                                        <li class="list-group-item"><strong>Postal Code:</strong> @Model.Address.PostalCode</li>
                                    }
                                    @if (!string.IsNullOrWhiteSpace(Model.Address.Country))
                                    {
                                        <li class="list-group-item"><strong>Country:</strong> @Model.Address.Country</li>
                                    }
                                    @if (!string.IsNullOrWhiteSpace(Model.Address.Phone))
                                    {
                                        <li class="list-group-item"><strong>Phone:</strong> @Model.Address.Phone</li>
                                    }
                                    @if (!string.IsNullOrWhiteSpace(Model.Address.Company))
                                    {
                                        <li class="list-group-item"><strong>Company:</strong> @Model.Address.Company</li>
                                    }
                                </ul>
                            }
                            else
                            {
                                <div class="text-center py-4">
                                    <i class="bi bi-house-slash fs-1 text-muted"></i>
                                    <p class="text-muted mt-3 mb-2">No address on file.</p>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="text-center mt-4">
                <a asp-controller="Profile" asp-action="Edit" class="btn btn-primary">
                    <i class="bi bi-pencil me-1"></i>Edit Profile
                </a>
            </div>
        }
        else
        {
            <div class="alert alert-warning text-center">
                <i class="bi bi-exclamation-triangle me-2"></i>User not found. Please log in.
            </div>
        }
    }
    catch (Exception ex)
    {
        <div class="card shadow-sm border-0 text-center p-5">
            <i class="bi bi-x-circle fs-1 text-danger mb-3"></i>
            <h3 class="fw-bold mb-2">Oops! Something went wrong</h3>
            <p class="text-secondary mb-4">We couldn't load your profile. Please try again later.</p>
            <small class="text-muted">Error: @ex.Message</small>
            <div class="mt-3">
                <a href="/" class="btn btn-primary me-2">
                    <i class="bi bi-house-door me-1"></i>Go Home
                </a>
                <a href="#" class="btn btn-secondary">
                    <i class="bi bi-arrow-repeat me-1"></i>Retry
                </a>
            </div>
        </div>
    }
</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
